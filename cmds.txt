ssh cuda5

cd ../../scratch/mc10322

git clone git@github.com:Monishver11/modded-nanogpt-moe.git

cd modded-nanogpt-moe

conda create -n nanogpt python=3.10 -y

conda activate nanogpt

pip install -r requirements.txt \
    --extra-index-url https://download.pytorch.org/whl/cu126

pip install --pre torch --index-url https://download.pytorch.org/whl/nightly/cu126 --upgrade

python3 - <<EOF
import torch
print(torch.__version__, torch.version.cuda)
EOF

2.9.1+cu128 12.8

# downloads only the first 900M training tokens to save time
python data/cached_fineweb10B.py 9

python train_gpt.py

